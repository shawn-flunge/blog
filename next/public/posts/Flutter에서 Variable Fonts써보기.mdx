---
id: 1
title: 'Flutter에서 Variable Fonts써보기'
date: 1708343875480
lastmod: '2024-02-27'
tags: ['Flutter', 'VariableFonts', 'Typography', 'Pretendard']
draft: false
summary: 'Pretendard 공식 홈페이지의 애니메이션 효과를 구현하며 Variable Fonts 알아보기'
---



블로그의 폰트를 정할때 별 생각 없이 Pretendard를 써야지 하고 길형진님의 블로그에 접속 했을때 처음으로 보이는 애니메이션에 매료 됐고 마침 Variable Fonts에 글을 쓰기로 했던터라 이 둘을 엮어서 글을 써보게 됐습니다.

/// 🚩 1

물론 일을하며, 개인 프로젝트를 하며 폰트를 쓸 일이 잦아 Variable Fonts의 존재는 알고 있었지만 TextStyle 클래스에 VariableFonts 속성이 없었던 것이 이유인지 아니면 디자인에 수동적인 자세를 취하던게 이유인지 깊게 생각할 일이 없었던거 같습니다.


# Variable Fonts
여러 가지 글꼴 형태를 단일 파일로 통합하는 형태의 글꼴을 Variable Fonts 혹은 가변 글꼴이라고 합니다. 하나의 파일로 글자의 굵기, 기울임, 너비 등을 조절할 수 있어 선택지가 다양해지고 관리 측면에서 장점이 있습니다.
[Google Fonts의 Variable Fonts에 대한 자세한 설명](https://fonts.google.com/knowledge/introducing_type/introducing_variable_fonts)


# 어떻게 사용할까?
그렇다면 Flutter에서는 어떻게 사용할까요?  
정적 파일을 이용해 글꼴을 나타낸다면 우리는 보통 아래와 같은 방식으로 사용했을 것입니다.
```
flutter:

  uses-material-design: true
  fonts:
    - family: Pretendard
      fonts:
        - asset: assets/fonts/Pretendard-Thin.otf
          weight: 100
        - asset: assets/fonts/Pretendard-ExtraLight.otf
          weight: 200
        - asset: assets/fonts/Pretendard-Light.otf
          weight: 300
        ...
```
Pretendard는 굵기 관련 파일을 9개 지원하기 때문에 weight별로 파일을 매칭시켜주게 됩니다.  
하지만 이런식으로 애니메이션을 구현하게 된다면 아래와 같은 결과를 얻게 됩니다.

/// 2. 🚩 Variable fonts 안쓰고 만들어서 실패한 위젯 gif

원하는 애니메이션은 자연스럽게 굵기가 바껴야 하는데 기존의 방식대로 하게 된다면 각각의 굵기 사이 값을 표현할 방법이 없기때문에 뚝뚝 끊기는 결과를 얻은것입니다.  
물론 100, 101, 102 ... 이런식으로 모든 weight를 추가하면 나아지겠지만 우리가 원하는 방식은 아닙니다.


# FontVariations
그렇기 때문에 우리는 Variable Fonts를 사용해야 하는데 Flutter에선 TextStyle의 FontVariations속성을 통해 표현할 수 있습니다.

```
flutter:

  uses-material-design: true
  fonts:
    - family: Pretendard
      fonts:
        - asset: assets/fonts/PretendardVariable.ttf
```
위와 같이 VariableFonts를 지원하는 글꼴이라면 그걸 다운 받아서 등록해주면 됩니다.   
그 후에 아래와 같이 TextStyle의 fontVariations속성에 FontVariation객체를 만들어 전달함으로써 사용할 수 있습니다. 우리는 굵기 변화를 통해 애니메이션을 구현할 것이기 때문에 `wght`의 값을 지정해 줍니다.
```
Text(
  'Hello World',
  style: TextStyle(
    fontFamily: 'Pretendard',
    fontVariations: [
      FontVariation('wght', 200)
    ]
  ),
);
```

# 구현
본격적으로 구현 해보겠습니다.










# Variable Fonts

여러 가지 글꼴 형태를 단일 파일로 통합하는 형태의 글꼴을 Variable Fonts 혹은 가변 글꼴이라고 합니다. 가변 글꼴은 하나의 파일로 글자의 굵기, 기울임, 너비 등을 조절할 수 있어 선택지가 다양해지고 파일의 크기가 작아짐에 따라 앱의 크기, 로딩등에 이점이 있습니다.

[Google Fonts의 Variable Fonts에 대한 자세한 설명](https://fonts.google.com/knowledge/introducing_type/introducing_variable_fonts)


전 Pretendard를 알고 난 후에는 이 글꼴을 자주 쓰게 되는데 그 때 마다 길형진님의 블로그에 들어가서 파일을 다운 받아 왔는데 어느날 다운로드 링크가 있는 글의 대문사진의 애니메이션을보고 문득 구현해보고 싶다는 생각을 했었는데 최근 웹 개발을 하며 Variable Fonts가 뭔지 알게 되었고 Flutter에서 대문 이미지의 애니메이션을 Variable Fonts를 사용해 구현해 봤습니다.

/// 🚩 Pretendard 대문 이미지 gif


# 기존 폰트 사용 시

```
flutter:

  uses-material-design: true
  fonts:
    - family: Pretendard
      fonts:
        - asset: assets/fonts/Pretendard-Thin.otf
          weight: 100
        - asset: assets/fonts/Pretendard-ExtraLight.otf
          weight: 200
        - asset: assets/fonts/Pretendard-Light.otf
          weight: 300
        - asset: assets/fonts/Pretendard-Regular.otf
          weight: 400
        - asset: assets/fonts/Pretendard-Medium.otf
          weight: 500
        - asset: assets/fonts/Pretendard-SemiBold.otf
          weight: 600
        - asset: assets/fonts/Pretendard-Bold.otf
          weight: 700
        - asset: assets/fonts/Pretendard-ExtraBold.otf
          weight: 800
        - asset: assets/fonts/Pretendard-Black.otf
          weight: 900
```
Pretendard는 총 9가지 형태의 굵기를 지원하기 때문에 모든 굵기를 사용하려면 위와같이 `pubspec.yaml`파일에 선언을 해줘야 합니다. Variable Fonts에 대해 알지 못할때 위와같이 폰트 설정을 한 후 애니메이션 위젯을 만들었는데 결과는 아래와 같았고 결과적으론 실패를 했었습니다.

/// 🚩 Variable fonts 안쓰고 만들어서 실패한 위젯 gif

그 이유는 각 파일로 정해진 굵기의 폰트만 지원하기 때문에 부드러운 애니메이션을 위해서라면 각각의 weight사이에 수십 혹은 수백개의 파일이 더 있어서 자연스럽게 폰트를 변경해줘야하는데 그렇지 않기 때문에 뚝뚝 끊기게 됩니다. 설사 수천개의 파일을 준비해서 등록을 한다 하더라도 앱의 크기가 어마어마해질것이고 프레임마다 폰트를 로드하는데 드는 비용도 만만치 않을것입니다.

## Flutter에서의 Variable Fonts
Flutter에서 Variable Fonts를 구현하는 방법은 FontVariation을 이용하는 것입니다. 이름은 약간 다르지만 하는 역할을 정확히 같습니다.
TextStyle클래스의 멤버 변수로 FontVariation타입의 List가 있는데 여기에 전달하 🏴‍☠ 여기서부터 이어서 작성

## 설정
본격적으로 구현을 시작해보겠습니다.
```
flutter:

  uses-material-design: true
  fonts:
    - family: Pretendard
      fonts:
        - asset: assets/fonts/PretendardVariable.ttf
```
`pubspec.yaml`에 Variable fonts파일 하나만 선언해주면 끝입니다.



처음에는 `AnimationBuilder -> Row -> Text` 순서로 구현을 해야겠다는 생각으로 구현 했습니다.

```
@override
  void initState() {
    super.initState();
    _controller = AnimationController(vsync: this, duration: const Duration(seconds: 3), lowerBound: 0, upperBound: 1);
    _controller.repeat(reverse: false);
  }

  @override
  void dispose() {
    _controller.dispose();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    return RepaintBoundary(
      child: AnimatedBuilder(
          animation: _controller,
          builder: (context, _) {

            return Row(
              mainAxisAlignment: MainAxisAlignment.center,
              children: List.generate(widget.text.length, (index) {

                final fw = FontWeight.lerp(FontWeight.w100, FontWeight.w900, _controller.value);
                return Text(
                  widget.text[index],
                  style: widget.style.copyWith(
                    fontWeight: fw
                  ),
                );
              }),
            );
          }
      ),
    );
  }
```
AnimationController를 각 글자별로 가질 필요가 없을거라 생각해 위와 같이 작성했지만 아래와 같은 결과를 얻게 됐습니다.

/// 🚩 2

다음으로는 각 글자별로 `AnimationBuilder`를 이용해 구현한 결과 입니다.

/// 🚩 3
훨씬 자연스러워 졌으나 뚝뚝 끊기는 느낌을 받습니다.

### RichText
Text위젯은 텍스트를 렌더링 하는 가장 보편적인 방법입니다. 그런데 이번에는 사용할 수가 없었는데 그 이유는 Flutter엔진이 텍스트를 렌더링 하는 과정에서 알 수가 있습니다.<br/>

화면에 그리고 -> 텍스트의 크기(화면에서 차지하는 면적)를 구하고 -> 상위 위젯에 알리는 과정을 거치게 되는데 Text위젯으로 글자를 나눠서 렌더링을 하게되면 모든 글자가 위의 3가지 과정을 매 프레임별로 수행하기 때문에 끊기는 현상이 발생한것입니다.

그렇기 때문에 각 글자를 한번에 그리고, 사이즈를 구하는 RichText를 사용하게 됐습니다.




